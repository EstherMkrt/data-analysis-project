---
title: "Analyse factorielle des correspondances des causes de décès par pays"
author: "MKRTCHYAN Yester, TOURE Fatoumata Salihou"
format:
  html:
    toc: true
    toc-depth: 3
    number-sections: true
  pdf:
    toc: true
    number-sections: true
editor: visual
---

# Introduction

En 2019, en Afrique subsaharienne, les maladies non transmissibles représentent environ 35 à 40 % des décès chez les adultes, d’après les données mondiales de l’OMS. Intuitivement, les infections pourraient pourtant être considérées comme dominantes, compte tenu du niveau de développement des pays. Cela soulève plusieurs questions centrales pour l’analyse : *Existe-t-il un lien entre le niveau de développement des pays et les différentes causes de décès ? Quels pays présentent des profils similaires de mortalité ?* Afin d’y répondre rigoureusement, il est pertinent de réaliser une Analyse Factorielle des Correspondances (AFC) sur les données enregistrées.

# Analyse factorielle des correspondances des causes de décès par pays

## Préparation des données

Pour cette analyse, nous avons utilisé un jeu de données disponible sur Kaggle, portant sur les causes de mortalité dans le monde dont le lien se trouve en annexe. Le jeu de données original couvre la période 1990 à 2019 et recense les effectifs de décès pour 204 pays et territoires, organisés sous la forme d’un tableau pays × causes de décès.

Afin de concentrer l’étude sur l’année la plus récente, nous avons extrait uniquement les observations de 2019. Une vérification préalable a confirmé l’absence de valeurs manquantes dans les variables retenues. Les données extraites ont ensuite été enregistrées dans un nouveau fichier CSV, distinct du fichier initial.

La variable correspondant à l’année a été supprimée du fait que toutes les lignes concernent 2019. De même, parmi les deux colonnes descriptives des pays (nom complet et abréviation), seule la colonne des abréviations a été conservée, les correspondances avec les noms complets étant stockées dans un fichier séparé.

Pour améliorer la lisibilité et faciliter l’interprétation graphique dans l’Analyse Factorielle des Correspondances (AFC), nous avons procédé à un encodage des différentes causes de décès, chaque cause étant associée à un identifiant plus court. Cet encodage a été enregistré dans un document séparé, qui sera également disponible en annexe.

Le jeu de données final comporte ainsi 204 lignes correspondant aux abréviations des pays et territoires, et des colonnes représentant les différentes causes de décès encodées, avec pour valeurs les effectifs observés. En étant deux variables qualitatives il convient de procéder à une AFC.

```{r}
#| echo: false 
#| warning: false
#| message: false

# chargement des librairies utiles

library(FactoMineR)
library(factoextra)
library(corrplot)
library(ggplot2)
library(psych)
library(skimr)
library(PCDimension)
library(knitr)

```

## Analyse exploratoire

### Chargement des données

La première étape de l'analyse consiste à charger les librairies nécessaires ainsi que le jeu de données à analyser dans le script R qui est le fichier CSV nettoyé. Après l’importation, une première visualisation globale du tableau est réalisée afin de vérifier la structure des données et la cohérence des variables.

Au moment du chargement de données, la première colonne du jeu de données est désigné comme étant la colonne d'identification des lignes et elle est ensuite supprimée, afin de ne conserver que les causes de décès sous forme numérique. Cette étape permet de faciliter les traitements ultérieurs et l’accès direct aux informations par pays.

Le jeu de données obtenu est stocké dans la variable "morts" pour le reste de l'analyse. Une vérification du jeu de données à l’aide de l’affichage des premières lignes confirme la bonne manipulation des données et l’absence d’anomalies apparentes.

### Visualisation des données par barplots

```{r}
#| echo: false
#| warning: false
#| message: false


# importation du jeu de données 

morts <- read.csv("cleaned_data.csv", header = TRUE, sep = ",")

# Déclaration de la colonne Country comme identificateur des individus

rownames(morts) <- morts[,1]

# Suppression de la variable country

morts <- morts[,-1]


#| fig-cap: "1) Répartition des causes de décès en Arménie en 2019"

par(mar = c(6,10,4,2))
barplot(
  as.numeric(morts["ARM", ]),
  names.arg = colnames(morts),
  col = "purple3",
  border = "white",
  main = "Arménie",
  horiz = TRUE,
  las = 1,
  xlab = "Nombre de décès"
)
```

```{r}
#| echo: false
#| warning: false
#| message: false

#| fig-cap: "2) Répartition des causes de décès au Mali en 2019"

par(mar = c(6,10,4,2))
barplot(
  as.numeric(morts["MLI", ]),
  names.arg = colnames(morts),
  col = "green",
  border = "white",
  main = "Mali",
  horiz = TRUE,
  las = 1,
  xlab = "Nombre de décès"
)
```

```{r}
#| echo: false

#| fig-cap: "3) Répartition des causes de décès en France en 2019"

par(mar = c(6,10,4,2))
barplot(
  as.numeric(morts["FRA", ]),
  names.arg = colnames(morts),
  col = "blue",
  border = "white",
  main = "France",
  horiz = TRUE,
  las = 1,
  xlab = "Nombre de décès"
)
```

### Comparaison des pays

Les Figures 1 à 3 présentent des diagrammes en barres horizontales illustrant le nombre de décès par cause respectivement en Arménie, au Mali et en France. Ces représentations graphiques ont pour objectif de comparer la structure de la mortalité selon les principales causes de décès dans chacun des pays étudiés.

Les causes de décès sont représentées sur l’axe des ordonnées, tandis que l’axe des abscisses indique le nombre de morts. Ce choix de visualisation permet une lecture claire et facilite la comparaison entre catégories.

L’analyse met en évidence des profils de mortalité contrastés. En Arménie, en 2019, les maladies cardiovasculaires (C12) sont responsables de plus de 12 000 décès, tandis que le néoplasme (C20) en représente environ 6 000. En France, ces mêmes causes figurent également parmi les principales causes de mortalité, avec plus de 15 000 décès pour le néoplasme et environ 20 000 pour la cause cardiovasculaires. À l’inverse, au Mali, les maladies transmissibles ainsi que certaines maladies infectueuses occupent une place plus importante dans la mortalité totale. Ils ont entraîné environ 32 000 décès, les maladies cardiovasculaires (C12) près de 20 000 décès, et l'automutilation et la malnutrition (C18 et C25) environ 14 000 décès chacune.

Cette analyse descriptive constitue une première étape exploratoire. Elle permet de dégager des tendances générales et justifie la poursuite de l’étude par des analyses comparatives plus approfondies entre pays et groupes de causes de décès.

### Profils ligne et colonne

Afin d’approfondir l’analyse descriptive, des profils lignes et des profils colonnes ont été construits à partir du tableau de contingence des décès par cause et par pays. Le profil ligne d’un pays correspond à la répartition relative des causes de décès à l’intérieur de ce pays : chaque valeur représente la proportion d’une cause donnée parmi l’ensemble des décès du pays considéré. Par exemple, en Afghanistan la meningite reperesente 0.7% des causes des décès en 2019 ($$
0{,}007 = \frac{1563}{1563 + 1775 + \cdots + 485 + 1940}
$$). Ainsi, la somme des proportions sur une ligne est égale à 1, ce qui permet de comparer les structures de mortalité indépendamment du niveau absolu de mortalité.

```{r}
#| echo: false
#| warning: false
#| message: false
# Tableau profil ligne



morts1 <- data.matrix(morts)

profils_lignes <- morts1 / rowSums(morts1)

profils_lignes <- as.data.frame(profils_lignes)


# Tableau profil colonne

# Passage en matrice numérique
morts1 <- data.matrix(morts)

# Somme des colonnes
somme_colonnes <- colSums(morts1)

# Profils colonnes
profils_colonnes <- sweep(morts1, 2, somme_colonnes, "/")

# Conversion en data.frame (optionnel)
profils_colonnes <- as.data.frame(profils_colonnes)


pays_selection <- c("AFG", "ARM", "MLI", "FRA", "MOZ", "AUS", "ARG", "USA")



causes_selection <- colnames(morts)[1:8]

kable(
  profils_lignes[pays_selection, causes_selection],
  caption = "Profils lignes pour quelques pays et causes sélectionnés"
)

kable(
  profils_colonnes[pays_selection, causes_selection],
  caption = "Profils colonnes pour quelques pays et causes sélectionnés"
)


```

De manière complémentaire, les profils colonnes décrivent, pour chaque cause de décès, la répartition relative des pays. Chaque valeur indique la contribution d’un pays donné au total des décès observés pour une cause spécifique . En 2019, l’Afghanistan représentait 0,66% ($$
0{,}0066 = \frac{1563}{1563 + 13 + \cdots + 2065 + 1450}
$$)de la mortalité mondiale due à la méningite. Là encore, la normalisation par colonne permet de comparer les pays entre eux pour une cause donnée, sans être influencé par les différences globales de population ou de mortalité.

### Comparaison des pays, graphiques de profils ligne et colonnes avec `ggplot2`

Les profils lignes sont ensuite représentés graphiquement afin de faciliter l’interprétation. Le profil ligne de la France met en évidence la prédominance des maladies non infectueuses dans la structure de la mortalité, confirmant les observations issues de l’analyse par diagrammes en barres. Une comparaison des profils lignes de la France et du Mali souligne des contrastes marqués : la France présente une concentration plus forte des décès sur les maladies chroniques, tandis que le Mali affiche une part relativement plus importante de maladies infectueuses et de causes évitables. Ces différences traduisent des stades distincts de transition épidémiologique et fournissent une base pertinente pour des analyses multivariées ultérieures, telles que l’analyse des correspondances.

```{r}
#| echo: false
#| warning: false
#| message: false
# Représentation graphique des profils



library(ggplot2)



# Extraction du profil ligne de la France
profil_france <- profils_lignes["FRA", , drop = FALSE]

# Transformation en data.frame “long” simple
profil_france_long <- data.frame(
  Variable = colnames(profil_france),
  Profil = as.numeric(profil_france[1, ])
)



# Diagramme (barplot)
ggplot(profil_france_long, aes(x = Variable, y = Profil)) +
  geom_col(fill = "steelblue") +
  labs(
    title = "Profil ligne de la France (FRA)",
    x = "Colonnes",
    y = "Proportion"
  ) +
  theme_minimal()
#comparaison de deux profils ligne

library(ggplot2)

# Sélection des deux profils ligne
profils_deux <- profils_lignes[c("FRA", "MLI"), , drop = FALSE]

# Transformation en data.frame “long” simple
profils_deux_long <- data.frame(
  Pays = rep(rownames(profils_deux), each = ncol(profils_deux)),
  Variable = rep(colnames(profils_deux), times = nrow(profils_deux)),
  Profil = as.numeric(t(profils_deux))
)

# Diagramme comparatif (barplot côte à côte)
ggplot(profils_deux_long, aes(x = Variable, y = Profil, fill = Pays)) +
  geom_col(position = "dodge") +
  labs(
    title = "Comparaison des profils ligne : France vs Mali",
    x = "Colonnes",
    y = "Proportion"
  ) +
  theme_minimal()


```

## Analyses avancées ( AFC et Tests)

### Test du khi-deux et V de Cramer

Afin d’évaluer statistiquement l’existence d’un lien entre les pays et les causes de décès, un test du khi-deux d’indépendance est réalisé à partir du tableau de contingence. L’hypothèse nulle H0 suppose l’indépendance entre le pays et la cause de décès, tandis que l’hypothèse alternative H1 postule l’existence d’une dépendance entre ces deux variables.

Le test met en évidence une statistique du khi-deux très élevée (36 396 969) associée à une p-value nulle, conduisant au rejet de l’hypothèse d’indépendance au seuil usuel. Cela suggère que la répartition des causes de décès diffère significativement selon les pays considérés. Toutefois, l’interprétation de ce résultat doit être nuancée, car la structure du tableau, notamment la présence de nombreux effectifs élevés et de fortes disparités entre pays limite la pertinence stricte du test du khi-deux.

Afin de quantifier l’intensité de la liaison entre les deux variables, le coefficient de V de Cramér est calculé. La valeur obtenue étant 0.149 indique une liaison faible entre le pays et la cause de décès, malgré le rejet de l’hypothèse d’indépendance. Ce résultat souligne que la dépendance statistique observée est réelle mais modérée.

Sous l'hypothèse d'indépendance, les profils attendus pour différents pays sont égaux. Nous le confirmons avec les exemples de la France et du Mali.

```{r}
#| echo: false
#| warning: false
#| message: false


resu.chi2 <- chisq.test(morts[1:204,])

resu.chi2 <- suppressWarnings(chisq.test(morts[1:204, ]))


# P-value 


# la structure du tableau ne permet pas vraiment de faire un test du ki deux, 
# on peut directement faire une AFC pour explorer les dépendances


# V Cramer

# effectifs attendus sous hyp d'indépendance : effectif théorique

resu.chi2$expected[1:5, 1:3]

tab_exp <- resu.chi2$expected[1:8, 1:8]


knitr::kable(
  tab_exp,
  caption = "Résidus attendus (extrait)",
  booktabs = TRUE,
  align = "c"
)


```

L’examen des effectifs attendus sous l’hypothèse d’indépendance ainsi que des résidus standardisés permet d’identifier les principales contributions au khi-deux. Ces écarts traduisent des phénomènes d’attirance et de répulsion : un résidu standardisé positif indique qu’un pays et une cause se rencontrent plus fréquemment que prévu (attirance), tandis qu’un résidu standardisé négatif montre une occurrence moindre que prévu (répulsion). Un résidu supérieur à 2 ou inférieur à −2 est généralement considéré comme significatif.

```{r}
#| echo: false
#| warning: false
#| message: false

 # Le tableau des résidus


tab_stdres <- resu.chi2$stdres[1:8, 1:8]


knitr::kable(
  tab_stdres,
  caption = "Résidus standardisés (extrait)",
  booktabs = TRUE,
  align = "c"
)

```

À titre d’illustration, le Bangladesh (BGD) présente un résidu standardisé de −99,09 pour la malaria (C5), ce qui traduit une répulsion extrêmement marquée : cette cause est très fortement sous-représentée dans ce pays par rapport à ce qui serait attendu sous l’hypothèse d’indépendance. À l’inverse, l’Afghanistan (AFG) affiche un résidu standardisé très élevé (116,45) pour les troubles maternels (C8), indiquant une attirance très forte entre ce pays et cette cause de décès, largement surreprésentée par rapport au modèle d’indépendance.

## Lancement de l’AFC

Pour explorer les relations entre les pays et les causes de décès, une analyse factorielle des correspondances (AFC) est réalisée. Cette méthode multivariée est particulièrement adaptée aux tableaux de contingence et permet de visualiser les dépendances entre lignes (pays) et colonnes (causes) tout en réduisant la dimensionnalité des données.

```{r}
#| echo: false
#| warning: false
#| message: false
#Lancement de l'AFC avec R



# AFC avec lignes actives = les 204 pays  
pres.afc <- CA(morts[1:204,])

# Pour éviter la superposition des libellés 
fviz_ca_biplot(pres.afc, repel = TRUE) +
  ggtitle(
    "Analyse factorielle des correspondances (AFC)",
    subtitle = "Représentation conjointe des pays et des causes de décès (axes 1 et 2)"
  )


#diagramme en baton pour étudier la décroissance de l'inertie des axes


fviz_eig(pres.afc, addlabels = TRUE) +
  ggtitle(
    "Décroissance de l’inertie des axes",
    subtitle = "Valeurs propres de l’AFC"
  )


```

L’AFC est appliquée aux 204 pays du tableau, considérés comme lignes actives. Les valeurs propres associées aux axes factoriels sont examinées afin de déterminer la part d’inertie expliquée par chaque axe et d’identifier le nombre d’axes significatifs à retenir. La décroissance des valeurs propres est représentée graphiquement pour faciliter l’interprétation. La somme des valeurs propres correspond à l’inertie totale du tableau, qui peut également être calculée à partir de la statistique du khi-deux normalisée par l’effectif total (Phi2). Dans les deux cas la valeur trouvée est 0.6695183.

Le critère de Kaiser est utilisé pour identifier les axes factoriels dont l’inertie dépasse la moyenne qui est 0.02231728, indiquant qu’ils expliquent une proportion d’information supérieure à celle attendue par hasard. Dans cette analyse, six axes présentent une inertie supérieure à la moyenne et sont donc retenus pour l’interprétation.

```{r}
#| echo: false
#| warning: false
#| message: false


# Eboulis des valeures propres



#pres.afc$eig


#pres.afc$eig


# Inertie totale

# Total du tableau (nb total de votes à l'issue du 1er tour)
tot <- sum(morts[1:204,])

# Inertie totale = D2/n
#resu.chi2$statistic/tot # La statistique D2/n est également appelée Phi2

# Inertie totale = somme des valeurs propres
#sum(pres.afc$eig[,1])

# On détermine le nombre d'axes intéressants de 2 façons différentes :

# Critère de Kaiser 


inertie_totale <- sum(pres.afc$eig[, 1])
nb_axes <- nrow(pres.afc$eig)
inertie_moyenne <- inertie_totale / nb_axes
#inertie_moyenne

#pres.afc$eig
inertie_axes <- pres.afc$eig[, 1]
barplot(
  inertie_axes,
  names.arg = paste("Axe", 1:length(inertie_axes)),
  main = "Décroissance de l’inertie des axes",
  xlab = "Axes factoriels",
  ylab = "Inertie",
  col = "lightblue",
  las = 2
)
# Ajout de la ligne de l’inertie moyenne
abline(
  h = inertie_moyenne,
  col = "red",
  lwd = 2,
  lty = 2
)

inertie_pct <- pres.afc$eig[, 2]

barplot(
  inertie_pct,
  names.arg = paste("Axe", 1:length(inertie_pct)),
  main = "Décroissance de l’inertie (en %)",
  xlab = "Axes factoriels",
  ylab = "Pourcentage d’inertie",
  col = "lightgreen",
  las = 2
)



#calcul de la valeur propremoyenne 

#mean(pres.afc$eig[,1])

# on note six axes dont l'inertie est supérieur






```

Les diagrammes de l’inertie totale et du pourcentage d’inertie permettent de visualiser la contribution relative de chaque axe à la structure globale des données, préparant ainsi l’interprétation des positions des pays et des causes sur les plans factoriels. Cette étape constitue un prérequis essentiel avant de produire les représentations graphiques des individus et des variables dans l’espace factoriel.

### Critère du bâton brisé pour sélectionner les axes

Pour compléter l’identification des axes significatifs, le critère du bâton brisé est utilisé. Les valeurs propres observées sont ainsi mises en relation avec les proportions théoriques du bâton brisé, permettant de distinguer les axes apportant une information réelle de ceux qui ne contiennent qu’un bruit statistique.

```{r}
#| echo: false
#| warning: false
#| message: false
# critère du baton brisé



#  Nombre d’axes factoriels (axes non nuls)
nb_axes <- nrow(pres.afc$eig)

#  Inertie observée issue de l’AFC (en %)
# Colonne 2 de pres.afc$eig = pourcentage d’inertie
vp <- pres.afc$eig[, 2]

#  Calcul du critère du bâton brisé (en %)
# brokenStick donne des proportions → on multiplie par 100
bs <- 100 * brokenStick(1:nb_axes, nb_axes)


#  Comparaison numérique : axes pertinents
# TRUE = axe retenu
vp > bs

# Axes retenus selon le critère du bâton brisé
#which(vp > bs)


barplot(
  rbind(vp, bs),
  beside = TRUE,
  names.arg = paste("Axe", 1:nb_axes),
  col = c("tomato1", "turquoise3"),
  border = "white",
  legend.text = c("Inertie observée", "Bâton brisé"),
  main = "Sélection des axes par le critère du bâton brisé",
  ylab = "Pourcentage d’inertie"
)

# avec broken stick on observe 4 axes interessants

```

La comparaison numérique indique que les axes dont l’inertie observée dépasse celle du bâton brisé sont considérés comme pertinents. Dans cette analyse, quatre axes présentent une inertie supérieure à la valeur attendue par le bâton brisé et sont donc retenus pour l’interprétation factorielle.

Un diagramme comparatif illustre visuellement la sélection des axes : les barres rouges représentant l’inertie observée sont mises côte à côte avec celles du bâton brisé, représentées en bleu. Cette représentation permet de visualiser aisément quels axes dépassent le seuil et confirment leur pertinence pour l’étude des relations entre les pays et les causes de décès. Ce critère identifiant moins d’axes pertinents que le critère de Kaiser, son résultat sera privilégié pour la suite de l’analyse.

### Analyse des contributions des lignes et colonnes

Après sélection des axes significatifs, l’AFC permet de représenter les modalités des lignes (pays) et des colonnes (causes) dans l’espace factoriel. Les diagrammes factoriels des lignes et des colonnes mettent en évidence les similitudes et les différences structurelles : les pays proches sur le plan factoriel présentent des profils de mortalité similaires, comme Djibouti et le Congo, tandis que les causes de décès rapprochées indiquent une co-occurrence relative dans différents pays. Par exemple, les troubles néonatals (C14), troubles maternels (C8) et maladies diarrhéiques(C18) apparaissent proches sur le graphique, suggérant qu’elles sont présentes dans des proportions comparables dans les mêmes pays. À l’inverse, la malaria (C5), très éloignée de l’origine et des autres modalités, présente un profil fortement spécifique, caractéristique d’un nombre limité de pays.

```{r}
#| echo: false
#| warning: false
#| message: false
# Plan des modalités lignes

fviz_ca_row(pres.afc, repel=T)



# Plan des modalités colonnes

fviz_ca_col(pres.afc, repel=T)+
  ggtitle("Plan des modalités colonnes")

# Premier plan factoriel

fviz_ca_biplot(pres.afc, axes = c(1,2), repel = T)+
  ggtitle("Plan factoriel des axes 1 et 2") # meilleur plan

```

Les biplots combinant simultanément les modalités des lignes (pays) et des colonnes (causes) permettent de visualiser les relations entre pays et causes de décès sur différents plans factoriels. Le premier plan factoriel, défini par les axes 1 et 2, est le plus informatif, concentrant une part importante de l’inertie totale avec 43 % pour l’axe 1 et 13,2 % pour l’axe 2. Il permet d’identifier les groupes de pays aux profils de mortalité similaires ainsi que les causes de décès les plus structurantes.

Les plans factoriels secondaires, explorés grâce aux combinaisons d’axes 1-3, 1-4, 3-2, 4-2 et 4-3, apportent des informations complémentaires sur les dimensions moins dominantes. Par exemple, le plan 1-3 explique 43 % et 10,5 % de l’inertie, le plan 1-4 contribue à 43 % et 8,7 %, et les autres plans permettent de mettre en évidence des variations supplémentaires entre pays et causes de décès. L’option repel = T utilisée dans les biplots améliore la lisibilité en évitant le chevauchement des étiquettes. L’analyse combinée de ces différents plans factoriels permet ainsi de mettre en évidence à la fois les structures principales et les relations secondaires dans les données.

```{r}
#| echo: false
#| warning: false
#| message: false

fviz_ca_biplot(pres.afc, axes = c(1,3), repel = T)+
  ggtitle("Plan factoriel des axes 1 et 3")

fviz_ca_biplot(pres.afc, axes = c(1,4))+
  ggtitle("Plan factoriel des axes 1 et 4")

fviz_ca_biplot(pres.afc, axes = c(3,2))+
  ggtitle("Plan factoriel des axes 3 et 2")

fviz_ca_biplot(pres.afc, axes = c(4,2))+
  ggtitle("Plan factoriel des axes 4 et 2")

fviz_ca_biplot(pres.afc, axes = c(4,3))+
  ggtitle("Plan factoriel des axes 4 et 3")

```

Pour approfondir l’interprétation, les contributions des lignes et des colonnes aux axes factoriels sont examinées. Les modalités les plus contributives sont identifiées, ce qui permet de se concentrer sur les pays et causes qui expliquent le mieux la variance sur chaque axe. Étant donné le grand nombre de pays (204), une sélection des dix premières contributions pour chaque axe facilite la lecture et l’interprétation des résultats. Sur l’axe 1, le Nigeria (NGA, ≈20%), la Chine et le Mozambique sont les principaux contributeurs, tandis que la malaria (C5) domine parmi les causes de décès (≈21%). L’axe 2 est fortement influencé par l’Afrique du Sud (ZAF, 33,8%) et le VIH (C9) (≈68%). L’axe 3 met en avant l’Afghanistan (AFG, 50,9%) et les conflits et terrorisme C21 (plus de 80%), et l’axe 4 est porté par l’Inde (IND, 24,2%) et la malaria (plus de 40%).

```{r}
#| echo: false
#| warning: false
#| message: false

#contributiob des lignes 


#sort(pres.afc$row$contrib[,1], T)
#sort(pres.afc$row$contrib[,2], T)

# Avec factoextra : plus facile à interpréter 
fviz_contrib(pres.afc, choice = "row", axes=1)+
  ggtitle("Contribution des pays pour l'axe 1")

fviz_contrib(pres.afc, choice = "row", axes=2)+
  ggtitle("Contribution des pays pour l'axe 2")

fviz_contrib(pres.afc, choice = "row", axes=3)+
  ggtitle("Contribution des pays pour l'axe ")

fviz_contrib(pres.afc, choice = "row", axes=4)+
  ggtitle("Contribution des pays pour l'axe 4")




#Diagramme illisible à cause du nombre de pays(204)
#Triage par ordre décroissant des contributions, puis séléction des 10 premiers


# Contributions des causes

#sort(pres.afc$col$contrib[,1], T)
#sort(pres.afc$col$contrib[,2], T)

# Avec factoextra : plus facile à interpréter

fviz_contrib(pres.afc, choice = "col", axes=1)+
  ggtitle("Contribution des causes de mortalité pour l'axe 1")

fviz_contrib(pres.afc, choice = "col", axes=2)+
  ggtitle("Contribution des causes de mortalité pour l'axe 2")

fviz_contrib(pres.afc, choice = "col", axes=3)+
  ggtitle("Contribution des causes de mortalité pour l'axe 3")

fviz_contrib(pres.afc, choice = "col", axes=4)+
  ggtitle("Contribution des causes de mortalité pour l'axe 4")

```

La qualité de représentation de chaque modalité est évaluée à l’aide du cos², qui mesure la proportion de la variance de la modalité expliquée par les axes retenus. Les modalités présentant un cos² élevé sont mieux représentées sur le plan factoriel et constituent des points de référence fiables pour l’interprétation. Pour rendre les graphiques plus lisibles, nous avons d’abord filtré les modalités avec un cos² supérieur à 0,7, garantissant ainsi que seules celles bien expliquées par les axes sont affichées. Ensuite un second filtrage a permis de sélectionner les 50 mieux représentées pour produire un autre graphique. Ces derniers utilisent un code couleur : les modalités les mieux représentées, avec un cos² proche de 1, apparaissent en couleur claire, tandis que celles avec un cos² proche de 0,7 apparaissent en couleur plus foncée.

```{r}
#| echo: false
#| warning: false
#| message: false
# Qualité de représentation

############ DONNER DES TITRES 


# Plan des modalités lignes (row) ou colonnes (col) selon les Qltés de représentation IL FAUT FAIRE DES CHOIX ICI

fviz_ca_row(pres.afc, col.row ="cos2", repel = T) 
fviz_ca_col(pres.afc, col.col="cos2", repel = T) 
fviz_ca_biplot(pres.afc, col.col="cos2", repel = T)

# En filtrant sur un cos2 > 0.7
fviz_ca_row(pres.afc, col.row = "cos2", select.row = list(cos2 = 0.7), repel = T)
# En filtrant sur les 20 meilleurs cos2
fviz_ca_row(pres.afc, col.row = "cos2", select.row = list(cos2 = 50), repel = T)


```

Cette analyse graphique et quantitative des contributions et de la qualité de représentation fournit une base solide pour tirer des conclusions sur les profils de mortalité et les relations entre pays et causes dans l’ensemble du jeu de données.

### Distances au centre de gravité

L’AFC permet de mesurer l’écart de chaque pays ou cause par rapport au profil moyen à travers la distance au centre de gravité (barycentre). Cette distance est calculée en rapportant l’inertie de chaque modalité à sa masse. Par exemple, dans notre analyse, le Bangladesh (BGD) présente la distance la plus faible (≈0,12), ce qui signifie que son profil est très proche du profil moyen, tandis que l’Afghanistan (AFG) a la distance la plus élevée (≈11,02), indiquant un profil fortement atypique.

Pour les causes, certaines présentent également des écarts importants : les conflits et terrorismes (C21) se distinguent par une distance très élevée (≈60,83), ce qui suggère un profil extrêmement spécifique par rapport aux autres causes. Ces mesures permettent ainsi de détecter les pays et causes qui se rapprochent le plus du profil moyen et ceux qui s’en écartent fortement.

La visualisation de ces distances, sous forme de diagrammes en barres verticales ou horizontales, facilite l’interprétation. Les barres les plus courtes correspondent aux profils proches de la moyenne, tandis que les barres plus longues signalent des profils atypiques.

```{r}
#| echo: false

#| warning: false
#| message: false
# Calcul et interprétation des distances au CG pour les pays...



# En déduire les distances aux CG : inertia/m_i

#pres.afc$row$inertia/pres.afc$call$marge.row
barplot(sort(pres.afc$row$inertia/pres.afc$call$marge.row), las=2, cex.names=0.6)

# Quel pays a le profil le plus proche du profil moyen ?
#which.min(pres.afc$row$inertia/pres.afc$call$marge.row)
# Quel pays a le profil le plus éloigné du profil moyen ?
#which.max(pres.afc$row$inertia/pres.afc$call$marge.row)

# Interprétation de ces distances 
# La distance évalue le caractère +/- atypique d'un profil en regard du profil moyen

# Pour les colonnes
#pres.afc$col$inertia/pres.afc$call$marge.col
barplot(sort(pres.afc$col$inertia/pres.afc$call$marge.col), las=2, cex.names=0.6)


# Distances représentées avec ggplot

dafr <- data.frame(distance = pres.afc$row$inertia/pres.afc$call$marge.row)
#summary(dafr)

# Barres verticales
ggplot(dafr, aes(x=reorder(row.names(dafr), -distance), y=distance)) +
  geom_col(fill = "steelblue")  +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1)) +
  labs(title="Distance au barycentre", x ="Pays", y = "Distance")




```

# Conclusion

L’objectif de ce travail était d’étudier l’existence d’un lien entre les causes de décès et les pays, et d’identifier d’éventuelles similarités de profils de mortalité entre ces derniers, en mobilisant l’analyse factorielle des correspondances. Les résultats obtenus permettent d’apporter des réponses claires aux questions formulées en introduction.

Tout d’abord, le test du khi-deux, complété par l’indice de V de Cramer, met en évidence l’existence d’une dépendance entre les pays et les causes de décès. Bien que cette dépendance demeure d’intensité modérée, elle est néanmoins significative et confirmée par la structure révélée par l’AFC. Cette analyse montre que les causes de décès ne se répartissent pas aléatoirement selon les pays, mais qu’elles sont associées à des profils nationaux spécifiques.

L’examen du plan factoriel met en lumière des regroupements cohérents de pays présentant des profils de mortalité similaires. Les pays dits développés, majoritairement situés en Europe, en Amérique du Nord ou dans certaines régions d’Asie, apparaissent proches du profil moyen. Leur mortalité est principalement dominée par des maladies chroniques et dégénératives, telles que les maladies cardiovasculaires, les maladies neurologiques ou celles liées au vieillissement. À l’inverse, de nombreux pays africains se situent à distance du centre de gravité et présentent des profils proches les uns des autres, caractérisés par une forte prévalence de maladies infectieuses, de la malnutrition, ainsi que de décès liés aux conflits ou à l’instabilité politique. Ces causes, fortement contributrices aux axes factoriels, expliquent une part importante de la dépendance observée. De manière similaire, certains pays en situation de crise hors du continent africain, tels que l’Afghanistan ou le Yémen, se distinguent également par des profils très éloignés du profil moyen, en lien avec des causes de mortalité spécifiques comme les conflits armés, le terrorisme, le paludisme ou le VIH.

Ainsi, les résultats obtenus apparaissent globalement cohérents avec le contexte géographique, géopolitique et socio-économique mondial. Ils confirment l’existence d’un lien entre le niveau de développement des pays et la structure de leur mortalité, ainsi que la présence de profils de décès similaires parmi des pays partageant des conditions de développement et de stabilité comparables. Ces observations doivent toutefois être interprétées avec prudence, au regard des limites liées à l’année étudiée et à l’agrégation des causes de décès.

# Annexe

## Source du jeu de données initiale

URL : https://www.kaggle.com/datasets/iamsouravbanerjee/cause-of-deaths-around-the-world

## Tableau de l'encodage des différentes causes de décès

```{r}
#| echo: false 
#| warning: false
#| message: false

codage <- read.csv("codage_causes.csv")
kable(
  codage,
  caption = "Encodage des causes de décès"
)

```
